<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Registration</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
</head>

<body class="bg-light">

<div class="container my-5">
    <div class="card shadow-sm bg-white p-4">
        <h2 class="mb-4">Registration</h2>

        <form id="registrationForm">

            <div class="mb-3">
                <label class="form-label">Name:</label>
                <input type="text" id="name" class="form-control" required>
                <div id="nameError" class="text-danger mt-1"></div>
            </div>

            <div class="mb-3">
                <label class="form-label">Age:</label>
                <input type="number" id="age" class="form-control" required>
                <div id="ageError" class="text-danger mt-1"></div>
            </div>

            <div class="mb-3">
                <label class="form-label">Email:</label>
                <input type="email" id="email" class="form-control" required>
                <div id="emailError" class="text-danger mt-1"></div>
            </div>

            <div class="mb-3">
                <label class="form-label">Password:</label>
                <input type="password" id="password" class="form-control" required>
                <div id="passwordError" class="text-danger mt-1"></div>
            </div>

            <button type="submit" class="btn btn-success">Sign up</button>
        </form>
    </div>
</div>

<script>
    $(document).ready(function () {

        $('#registrationForm').submit(function (e) {
            e.preventDefault();

            $('.text-danger').text('');

            let userDto = {
                name: $('#name').val(),
                age: parseInt($('#age').val()),
                email: $('#email').val(),
                password: $('#password').val()
            };

            $.ajax({
                url: '/api/admin/registration',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(userDto),

                success: function () {
                    alert('Пользователь успешно зарегистрирован!');
                    window.location.href = '/login';
                },

                error: function (err) {
                    if (err.responseJSON && err.responseJSON.message) {
                        $('#nameError').text(err.responseJSON.message);
                    } else {
                        alert('Ошибка сервера. Попробуйте позже.');
                        console.error(err);
                    }
                }
            });
        });

    });
</script>

</body>
</html>
